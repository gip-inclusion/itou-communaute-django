{% load i18n %}
{% load str_filters %}

<div id="upvotesarea{{post.pk}}" class="d-inline-block">
    {% with post.upvotes_count as counter %}
        {% if user.is_authenticated %}
            <form hx-post="{%  url 'forum_upvote:upvote' %}"
                id="upvote-button{{post.pk}}"
                hx-target="#upvotesarea{{post.pk}}"
                hx-swap="outerHTML">
                <input type='hidden' name='post_pk' value="{{post.pk}}"/>
                <input type='hidden' name='pk' value="{{post.topic.pk}}"/>

                <button type="submit"
                    class="btn btn-ico btn-link px-0 text-nowrap matomo-event"
                    data-matomo-category="engagement"
                    data-matomo-action="upvote"
                    data-matomo-option="{% if post.has_upvoted %}downvote{% else %}upvote{% endif %}"
                >
                    <span class="mr-1">{% trans "UpVotes" %}</span>
                    <i class="{% if post.has_upvoted %}ri-star-fill{% else %}ri-star-line{% endif %}" aria-hidden="true"></i><span class="ml-1">{{counter}}</span>
                </button>
            </form>
        {% else %}
            <a href="{% inclusion_connect_url next_url post.id %}" class="btn btn-ico btn-link pr-0 text-nowrap" data-toggle="tooltip" data-placement="top" title="Connectez-vous pour contribuer">
                <span class="mr-1">{% trans "UpVotes" %}</span>
                <i class="{% if post.has_upvoted %}ri-star-fill{% else %}ri-star-line{% endif %}" aria-hidden="true"></i><span class="ml-1">{{counter}}</span>
            </a>
        {% endif %}
    {% endwith %}
</div>
